{"version":3,"sources":["../../src/routes/accountAPI.js"],"names":["router","express","Router","get","req","res","next","fb_id","query","fbid","model","user","findOne","where","then","result","status","json","is_linking","token","auth_jwt","encode","id","catch","ex","err","module","exports"],"mappings":";;AAAA;;;;AACA;;;;AAEA;;;;AAEA,MAAMA,SAASC,kBAAQC,MAAR,EAAf;;AAIA;;;;;;;AAQAF,OAAOG,GAAP,CAAW,OAAX,EAAoB,UAASC,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAyB;AAC5C;AACA,OAAMC,QAAQH,IAAII,KAAJ,CAAUC,IAAxB;;AAEAC,iBAAMC,IAAN,CAAWC,OAAX,CAAmB;AAClBC,SAAM;AACLN,UAAMA;AADD;AADY,EAAnB,EAKCO,IALD,CAKOC,MAAD,IAAU;AACf,MAAGA,MAAH,EAAU;AACTV,OAAIW,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACpBC,gBAAW,IADS;AAEpBC,WAAMC,eAASC,MAAT,CAAgB;AACrBC,SAAGP,OAAOZ,GAAP,CAAW,MAAX;AADkB,KAAhB;AAFc,IAArB;AAMA,GAPD,MAOK;AACJE,OAAIW,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACpBC,gBAAW;AADS,IAArB;AAGA;AACD,EAlBD,EAmBCK,KAnBD,CAmBQC,EAAD,IAAM;AACZnB,MAAIW,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACpBQ,QAAI,KAAGD,EADa;AAEpBN,eAAW;AAFS,GAArB;AAIA,EAxBD;AAyBA,CA7BD;;AA+BAQ,OAAOC,OAAP,GAAiB3B,MAAjB","file":"accountAPI.js","sourcesContent":["import express from \"express\";\r\nimport model from \"../model\";\r\n\r\nimport {auth_jwt} from \"../auth\";\r\n\r\nconst router = express.Router();\r\n\r\n\r\n\r\n/*\r\n\tCác bước lấy info người sử\r\n\tQuản lý thông tin người dùng trên hệ thông\r\n\r\n\r\n*/\r\n\r\n\r\nrouter.get('/fbid', function(req, res, next) {\r\n\t//Kiểm tra fbid có được liên kết với tài khoản nào hay không\r\n\tconst fb_id = req.query.fbid;\r\n\r\n\tmodel.user.findOne({\r\n\t\twhere:{\r\n\t\t\tfb_id:fb_id,\r\n\t\t}\r\n\t})\r\n\t.then((result)=>{\r\n\t\tif(result){\r\n\t\t\tres.status(200).json({\r\n\t\t\t\tis_linking:true,\r\n\t\t\t\ttoken:auth_jwt.encode({\r\n\t\t\t\t\tid:result.get(\"mssv\"),\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t}else{\r\n\t\t\tres.status(200).json({\r\n\t\t\t\tis_linking:false\r\n\t\t\t})\r\n\t\t}\r\n\t})\r\n\t.catch((ex)=>{\r\n\t\tres.status(200).json({\r\n\t\t\terr:''+ex,\r\n\t\t\tis_linking:false\r\n\t\t})\r\n\t})\r\n});\r\n\r\nmodule.exports = router;\r\n"]}