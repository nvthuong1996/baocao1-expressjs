{"version":3,"sources":["../../src/messenger-api-helpers/thread-setup.js"],"names":["SERVER_URL","messengerconfig","goHome","type","title","url","webview_height_ratio","messenger_extensions","changeGiftButton","payload","JSON","stringify","persistentMenu","setting_type","thread_state","call_to_actions","getStarted","setDomainWhitelisting","api","callThreadAPI","whitelisted_domains","domain_action_type","setPersistentMenu","setGetStarted"],"mappings":";;;;;;AAQA;;;;AACA;;;;AAGA;;;;;;;AAZA;;;;;;;AAOA;AAYA,MAAMA,aAAaC,wBAAgBD,UAAnC;;AAGA,MAAME,SAAS;AACbC,QAAM,SADO;AAEbC,SAAO,cAFM;AAGbC,OAAM,GAAEL,UAAW,GAHN;AAIbM,wBAAsB,MAJT;AAKbC,wBAAsB;AALT,CAAf;;AAQA,MAAMC,mBAAmB;AACvBL,QAAM,UADiB;AAEvBC,SAAO,aAFgB;AAGvBK,WAASC,KAAKC,SAAL,CAAe;AACtBR,UAAM;AADgB,GAAf;AAHc,CAAzB;;AAQA,MAAMS,iBAAiB;AACrBC,gBAAc,iBADO;AAErBC,gBAAc,iBAFO;AAGrBC,mBAAiB,CACfP,gBADe;AAHI,CAAvB;;AAQA,MAAMQ,aAAa;AACjBH,gBAAc,iBADG;AAEjBC,gBAAc,YAFG;AAGjBC,mBAAiB,CACf;AACEN,aAASC,KAAKC,SAAL,CAAe;AACtBR,YAAM;AADgB,KAAf;AADX,GADe;AAHA,CAAnB;;AAiBA;;;;;;;;AAQA,MAAMc,wBAAwB,MAAM;AAClCC,gBAAIC,aAAJ,CACE;AACEN,kBAAc,qBADhB;AAEEO,yBAAqB,CAACpB,UAAD,CAFvB;AAGEqB,wBAAoB;AAHtB,GADF;AAOD,CARD;;AAUA;;;;;AAKA,MAAMC,oBAAoB,MAAM;AAC9BJ,gBAAIC,aAAJ,CACE;AACEN,kBAAc,iBADhB;AAEEC,kBAAc,iBAFhB;AAGEC,qBAAiB,CACf;AACEZ,YAAM,SADR;AAEEC,aAAO,cAFT;AAGEC,WAAM,GAAEL,UAAW,QAHrB;AAIEM,4BAAsB,MAJxB;AAKEC,4BAAsB;AALxB,KADe;AAHnB,GADF;AAeD,CAhBD;;AAkBA;;;;;AAKA,MAAMgB,gBAAgB,MAAM;AAC1BL,gBAAIC,aAAJ,CAAkBH,UAAlB;AACD,CAFD;;kBAIe;AACbC,uBADa;AAEbK,mBAFa;AAGbC;AAHa,C","file":"thread-setup.js","sourcesContent":["/**\r\n * Copyright 2017-present, Facebook, Inc. All rights reserved.\r\n *\r\n * This source code is licensed under the license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\n// ===== MESSENGER =============================================================\r\nimport api from './api';\r\nimport {messengerconfig} from '../../config.json';\r\n\r\n\r\n/*\r\n * SETUP\r\n *\r\n * Methods that should only be called at first run\r\n * that help set up Messenger related config\r\n */\r\n\r\nconst SERVER_URL = messengerconfig.SERVER_URL;\r\n\r\n\r\nconst goHome = {\r\n  type: 'web_url',\r\n  title: 'Ptit Chatbox',\r\n  url: `${SERVER_URL}/`,\r\n  webview_height_ratio: 'tall',\r\n  messenger_extensions: true,\r\n};\r\n\r\nconst changeGiftButton = {\r\n  type: 'postback',\r\n  title: 'Change Gift',\r\n  payload: JSON.stringify({\r\n    type: 'CHANGE_GIFT',\r\n  }),\r\n};\r\n\r\nconst persistentMenu = {\r\n  setting_type: 'call_to_actions',\r\n  thread_state: 'existing_thread',\r\n  call_to_actions: [\r\n    changeGiftButton\r\n  ],\r\n};\r\n\r\nconst getStarted = {\r\n  setting_type: 'call_to_actions',\r\n  thread_state: 'new_thread',\r\n  call_to_actions: [\r\n    {\r\n      payload: JSON.stringify({\r\n        type: 'GET_STARTED',\r\n      }),\r\n    },\r\n  ],\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Adds the server url to the Messenger App's whitelist.\r\n *\r\n * This is required to use Messenger Extensions which\r\n * this demo uses to get UserId's from a Messenger WebView.\r\n *\r\n * @returns {undefined}\r\n */\r\nconst setDomainWhitelisting = () => {\r\n  api.callThreadAPI(\r\n    {\r\n      setting_type: 'domain_whitelisting',\r\n      whitelisted_domains: [SERVER_URL],\r\n      domain_action_type: 'add',\r\n    }\r\n  );\r\n};\r\n\r\n/**\r\n * Sets the persistent menu for the application\r\n *\r\n * @returns {undefined}\r\n */\r\nconst setPersistentMenu = () => {\r\n  api.callThreadAPI(\r\n    {\r\n      setting_type: 'call_to_actions',\r\n      thread_state: 'existing_thread',\r\n      call_to_actions: [\r\n        {\r\n          type: 'web_url',\r\n          title: 'Ptit Chatbox',\r\n          url: `${SERVER_URL}/login`,\r\n          webview_height_ratio: 'full',\r\n          messenger_extensions: true,\r\n        }\r\n      ],\r\n    }\r\n  );\r\n};\r\n\r\n/**\r\n * Sets the Get Started button for the application\r\n *\r\n * @returns {undefined}\r\n */\r\nconst setGetStarted = () => {\r\n  api.callThreadAPI(getStarted);\r\n};\r\n\r\nexport default {\r\n  setDomainWhitelisting,\r\n  setPersistentMenu,\r\n  setGetStarted,\r\n};\r\n"]}