{"version":3,"sources":["../../src/messenger-api-helpers/fba-logging.js"],"names":["APP_ID","process","env","PAGE_ID","fbLog","eventName","payload","psid","request","post","url","form","event","custom_events","JSON","stringify","advertiser_tracking_enabled","application_tracking_enabled","extinfo","page_id","page_scoped_user_id","err","httpResponse","body","console","error","log","statusCode"],"mappings":";;;;;;AAQA;;;;;;AAEA,MAAMA,SAASC,QAAQC,GAAR,CAAYF,MAA3B,C,CAVA;;;;;;;AAOA;;AAIA,MAAMG,UAAUF,QAAQC,GAAR,CAAYC,OAA5B;;AAEA;;;;;;;;;AASA,MAAMC,QAAQ,CAACC,SAAD,EAAYC,OAAZ,EAAqBC,IAArB,KAA8B;AAC1C,MAAID,YAAY,IAAZ,IAAoB,OAAOA,OAAP,KAAmB,QAA3C,EAAqD;AACnDA,YAAQ,YAAR,IAAwBD,SAAxB;AACAG,sBAAQC,IAAR,CAAa;AACXC,WAAM,gCAAgCV,MAAhC,GAAyC,aADpC;AAEXW,YAAM;AACJC,eAAO,mBADH;AAEJC,uBAAeC,KAAKC,SAAL,CAAe,CAACT,OAAD,CAAf,CAFX;AAGJU,qCAA6B,CAHzB;AAIJC,sCAA8B,CAJ1B;AAKJC,iBAASJ,KAAKC,SAAL,CAAe,CAAC,KAAD,CAAf,CALL;AAMJI,iBAAShB,OANL;AAOJiB,6BAAqBb;AAPjB;AAFK,KAAb,EAWG,UAASc,GAAT,EAAaC,YAAb,EAA0BC,IAA1B,EAA+B;AAChCC,cAAQC,KAAR,CAAcJ,GAAd;AACAG,cAAQE,GAAR,CAAYJ,aAAaK,UAAzB;AACAH,cAAQE,GAAR,CAAYH,IAAZ;AACD,KAfD;AAgBD,GAlBD,MAkBO;AACLC,YAAQE,GAAR,CAAY,iCAAZ;AACD;AACF,CAtBD;;kBAwBe;AACbtB;AADa,C","file":"fba-logging.js","sourcesContent":["/**\r\n * Copyright 2017-present, Facebook, Inc. All rights reserved.\r\n *\r\n * This source code is licensed under the license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\n// ===== MODULES ===============================================================\r\nimport request from 'request';\r\n\r\nconst APP_ID = process.env.APP_ID;\r\nconst PAGE_ID = process.env.PAGE_ID;\r\n\r\n/**\r\n * For logging custom events to FB Analytics dashboard from server -\r\n * facebook.com/analytics\r\n *\r\n * @param {string} eventName - Name of event in fb analytics.\r\n * @param {string} payload - Parameters stored with event in fb analytics.\r\n * @param {string} psid - PSID of user who triggered the event.\r\n * @returns {undefined}\r\n */\r\nconst fbLog = (eventName, payload, psid) => {\r\n  if (payload !== null && typeof payload === 'object') {\r\n    payload[\"_eventName\"] = eventName;\r\n    request.post({\r\n      url : \"https://graph.facebook.com/\" + APP_ID + \"/activities\",\r\n      form: {\r\n        event: 'CUSTOM_APP_EVENTS',\r\n        custom_events: JSON.stringify([payload]),\r\n        advertiser_tracking_enabled: 0,\r\n        application_tracking_enabled: 0,\r\n        extinfo: JSON.stringify(['mb1']),\r\n        page_id: PAGE_ID,\r\n        page_scoped_user_id: psid\r\n      }\r\n    }, function(err,httpResponse,body){\r\n      console.error(err);\r\n      console.log(httpResponse.statusCode);\r\n      console.log(body);\r\n    });\r\n  } else {\r\n    console.log(\"Invalid payload for fb logging.\");\r\n  }\r\n};\r\n\r\nexport default {\r\n  fbLog,\r\n};\r\n"]}